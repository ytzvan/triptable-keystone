<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/12.1.1/css/intlTelInput.css">
<!-- Titlebar
================================================== -->
<div id="titlebar">
	<div class="container">
		<div class="row">
			<div class="col-md-12">

				<h2>Booking</h2>

				<!-- Breadcrumbs -->
				<nav id="breadcrumbs">
					<ul>
						<li><a href="#">Home</a></li>
						<li>Booking</li>
					</ul>
				</nav>

			</div>
		</div>
	</div>
</div>


<!-- Content
================================================== -->

<!-- Container -->
<div class="container">
	<div class="row">
		{{#if messages.error}}
		<div class="notification error ">
				<p><span>Error!</span> {{messages.error}}</p>
				<a class="close"></a>
			</div>
		{{/if}}
		

		<!-- Content
		================================================== -->
		<div class="col-lg-8 col-md-8 padding-right-30">

			<h3 class="margin-top-0 margin-bottom-30">Personal Details</h3>
			<form method="POST" id="bookingForm" action="/contact/{{data.tour.tourId}}">
			<input type="hidden" name="action" value="booking">
			<input type="hidden" name="tour" placeholder="TourID" class="form-control" value="{{data.tour.tourId}}">
			<input type="hidden" name="tourName" placeholder="tourName" class="form-control" value="{{data.tour.name}}">
			<input type="hidden" name="tourPrice" placeholder="TourPrice" class="form-control" value="{{data.tour.price}}">
  			<!--<input type="hidden" name="user" placeholder="UserId" class="form-control" value="{{data.user._id}}">-->
  			<input type="hidden" name="user" placeholder="UserId" class="form-control" value="57349555510ff303009739f3">
			<input type="hidden" name="tourUrl" placeholder="tourUrl" class="form-control" value="{{data.tour.slug}}">
			<input type="hidden" name="operatorEmail" placeholder="OpEmail" class="form-control" value="{{data.tour.owner.email}}">
			<input type="hidden" name="operatorName" placeholder="OpName" class="form-control" value="{{data.tour.owner.name.full}}">
			<input type="hidden" name="operator" placeholder="OpId" class="form-control" value="{{data.tour.owner._id}}">
			<input type="hidden" name="operatorCellphone" placeholder="OpCel" class="form-control" value="{{data.tour.owner.cellphone}}">
			<!-- People -->
			<input type="hidden" id="nOfAdults" name="nOfAdults"value="{{data.nOfAdults}}">
			<input type="hidden" id="nOfChildren" name="nOfChildren"value="{{data.nOfChildren}}">
			<input type="hidden" id="nOfInfants" name="nOfInfants"value="{{data.nOfInfants}}">

			<!--prices -->
				<input type="hidden" id="adultTotalPrice" name="adultTotalPrice"value="{{data.tour.adultTotalPrice}}">
				<input type="hidden" id="childPrice" name="childPrice"value="{{data.tour.childPrice}}">
				<input type="hidden" id="childTotalPrice" name="childTotalPrice"value="{{price.children}}">
				<input type="hidden" id="infantPrice" name="infantPrice"value="{{data.tour.infantPrice}}">
				<input type="hidden" id="infantTotalPrice" name="infantTotalPrice"value="{{price.infant}}">
			<!-- New fields -->
			<input type="hidden" name="date" value="{{formData.date}}">
			<input type="hidden" name="bookingTime" value="{{formData.bookingTime}}">
			<div class="row">
				

				<div class="col-md-6">
					<label>First Name</label>
					<input type="text" id="firstName" name="name.first" value="">
				</div>

				<div class="col-md-6">
					<label>Last Name</label>
					<input type="text"  id="lastName" name="name.last" value="">
				</div>

				<div class="col-md-6">
					<div class="input-with-icon medium-icons">
						<label>E-Mail Address</label>
						<input type="email"  id="email" name="email" value="">
						<i class="im im-icon-Mail"></i>
					</div>
				</div>

				<div class="col-md-6">
					<div class="input-with-icon medium-icons">
						<label>Phone / Whatsapp</label>
						<input type="tel"  id="phone" name="phone" id="phone">
					</div>
				</div>
				<div class="col-md-12">
					<div class="input-with-icon medium-icons">
						<label>Hotel Name or Address</label>
						<input type="text"  id="address" name="hotel"  value="">
						<i class="im im-icon-Phone-2"></i>
					</div>
				</div>

			</div>


			<h3 class="margin-top-55 margin-bottom-30">Payment Method</h3>

			<!-- Payment Methods Accordion -->
			<div class="payment">

				<div class="payment-tab">
					<div class="payment-tab-trigger">
						<input id="paypal" name="cardType" type="radio" value="paypal">
						<label for="paypal">Cash</label>
						<!--<img class="payment-logo paypal" src="https://i.imgur.com/ApBxkXU.png" alt=""> -->
					</div>

					<div class="payment-tab-content">
						<p>You will be redirected to PayPal to complete payment.</p>
					</div>
				</div>


				<div class="payment-tab payment-tab-active">
					<div class="payment-tab-trigger">
						<input checked type="radio" name="cardType" id="creditCart" value="creditCard">
						<label for="creditCart">Credit / Debit Card</label>
						<img class="payment-logo" src="https://i.imgur.com/IHEKLgm.png" alt="">
					</div>

					<div class="payment-tab-content">
						<div class="row">

							<div class="col-md-6">
								<div class="card-label">
									<label for="nameOnCard">Name on Card</label>
									<input id="nameOnCard" name="cardholder" required type="text">
								</div>
							</div>

							<div class="col-md-6">
								<div class="card-label">
									<label for="cardNumber">Card Number</label>
									<input id="cardNumber" name="cardNumber" placeholder="1234  5678  9876  5432" required type="tel">
								</div>
							</div>

							<div class="col-md-4">
								<div class="card-label">
									<label for="expirynDate">Expiry Month</label>
									<input id="expiryDateMonth" placeholder="MM" type="tel" required>
								</div>
							</div>

							<div class="col-md-4">
								<div class="card-label">
									<label for="expiryDate">Expiry Year</label>
									<input id="expirynDateYear" placeholder="YY" required type="tel">
								</div>
							</div>
							<input type="hidden" id="expirationField" name="expiration" value="09/20">
							<div class="col-md-4">
								<div class="card-label">
									<label for="cvv">CVV</label>
									<input id="cvv" required name="cvv2" placeholder="· · ·" type="tel">
								</div>
							</div>

						</div>
					</div>
				</div>

			</div>
			<!-- Payment Methods Accordion / End -->
		
			<button type="submit" class="button booking-confirmation-btn margin-top-40 margin-bottom-65">Confirm and Pay</button>
			</form>
		</div>


		<!-- Sidebar
		================================================== -->
		<div class="col-lg-4 col-md-4 margin-top-0 margin-bottom-60">

			<!-- Booking Summary -->
			<div class="listing-item-container compact order-summary-widget">
				<div class="listing-item">
					<img src="https://res.cloudinary.com/triptable/image/upload/w_600/v{{data.tour.heroImage.version}}/{{data.tour.heroImage.public_id}}.{{data.tour.heroImage.format}}" alt="">

					<div class="listing-item-content">
						<!--<div class="numerical-rating" data-rating="5.0"></div>-->
						<h3>{{data.tour.name}}</h3>
						<span><i class="fa fa-map-marker"></i> {{data.tour.city.city}}, {{data.tour.country.country}}</span>
					</div>
				</div>
			</div>
			<div class="boxed-widget opening-hours summary margin-top-0">
				<h3><i class="fa fa-calendar-check-o"></i> Booking Summary</h3>
				<ul>
					<li>Date <span>{{formData.formatDate}}</span></li>
					<li>Hour <span>{{formData.bookingTime}}</span></li>
					<li>Adults <i class="price">{{data.nOfAdults}} x {{getPriceInCurrency price.adultsPrice}} {{getCurrency}}</i><span>{{getPriceInCurrency price.adults}} {{getCurrency}}</span></li>
					<li>Children <i class="price"> {{data.nOfChildren}} x {{getPriceInCurrency data.tour.childPrice}} {{getCurrency}}</i><span>{{getPriceInCurrency price.children}} {{getCurrency}}</span></li>
					<li>Infants <i class="price"> {{data.nOfInfants}} x {{getPriceInCurrency data.tour.infantPrice}} {{getCurrency}}</i><span>{{getPriceInCurrency price.infant}} {{getCurrency}}</span></li>
					<li class="total-costs">Total Cost <span>{{getPriceInCurrency price.total}} {{getCurrency}}</span></li>
				</ul>

			</div>
			<!-- Booking Summary / End -->

		</div>

	</div>
</div>
<!-- Container / End -->
<script>
	document.addEventListener("DOMContentLoaded", function() {
		if (localStorage) {
			$('#firstName').val(localStorage.firstName);
			$('#lastName').val(localStorage.lastName);
			$('#email').val(localStorage.email);
			$('#phone').val(localStorage.phone);
			$('#address').val(localStorage.address);
			//CC
			$('#nameOnCard').val(localStorage.nameOnCard);
			$('#cardNumber').val(localStorage.cardNumber);
		}
		$("#phone").intlTelInput({
			nationalMode: false,
			preferredCountries : ["pa", "co", "us", "es"],
			utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/12.1.1/js/utils.js",
			autoPlaceholder: "polite"
		});

		$("#bookingForm").submit( function() {
			
			// GET

			var firstName = $('#firstName').val();
			localStorage.setItem("firstName", firstName);

			var lastName = $('#lastName').val();
			localStorage.setItem("lastName", lastName);

			var email = $('#email').val();
			localStorage.setItem("email", email);

			var phone = $('#phone').val();
			localStorage.setItem("phone", phone);

			var address = $('#address').val();
			localStorage.setItem("address", address);
			// CC Data
			var nameOnCard = $('#nameOnCard').val();
			localStorage.setItem("nameOnCard", nameOnCard);

			var cardNumber = $('#cardNumber').val();
			localStorage.setItem("cardNumber", cardNumber);


      return true;
 	 	});



	});

</script>